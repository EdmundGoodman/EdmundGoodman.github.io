<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Github Token Authentication | Edmund Goodman</title>
<meta name=author content="Edmund Goodman"><meta name=description content="The personal website for Edmund Goodman"><meta http-equiv=content-language content="en-uk"><link rel=icon href=/images/favicon.ico sizes=any type=image/x-icon><link rel=stylesheet type=text/css href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.0/font/bootstrap-icons.min.css><link rel=stylesheet type=text/css href=https://edmundgoodman.github.io/css/styles.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.3.0/respond.min.js></script><script src=/js/main.js defer></script></head><body><section id=top-nav><nav><span class="nav-item nav-logo"><a href=/ class=nav-link>Home</a></span><ul class=nav-menu><li class="nav-item nav-normal"><a href=/about class=nav-link>About</a></li><li class="nav-item nav-normal"><a href=/posts/ class=nav-link>Blog</a></li><li class="nav-item hamburger-container"><input id=popout-nav-toggle name=popout-nav-toggle class=popout-nav-toggle type=checkbox onclick=changeNav()><div class=hamburger-lines><span class="line line1"></span>
<span class="line line2"></span>
<span class="line line3"></span></div></li></ul></nav></section><div id=popout-nav class=overlay><div class=overlay-content><span><a href=/ class=nav-link>Home</a></span><span><a href=/about class=nav-link>About</a></span>
<span><a href=/posts/ class=nav-link>Blog</a></span></div></div><script>function changeNav(){document.querySelector("input[name=popout-nav-toggle]").checked?document.getElementById("popout-nav").style.width="100%":document.getElementById("popout-nav").style.width="0%"}</script><section id=page-content><header><h1>Github Token Authentication</h1><div class=post-meta><div class=separated-items><span class=separated-item><i class="bi bi-calendar"></i>
<time datetime=2024-01-31>Jan 31, 2024</time>
</span><span class=separated-item><i class="bi bi-clock"></i>5 minutes</span></div></div></header><article><div class="admonition note"><div class=admonition-title>A note on provenance:</div><div class=admonition-content><p>I originally wrote <a href=https://uwcs.co.uk/resources/github-token-authentication/>this guide</a> for the University of Warwick Computing Society to pre-empt common issues when authenticating to GitHub from the command line during academic workshops, such as <a href=https://uwcs.co.uk/resources/git-good/>Git Good</a>.</p><p>Since I wrote the guide, I have switched from using personal access tokens to
SSH keys for authentication. This incurs the slight annoyance of requiring SSH
rather than HTTPS remotes, but avoids the requirement of storing plaintext
tokens locally &ndash; instead using a password-protected SSH key. Additionally, on
MacOS, the password can be stored in the user keychain, so is not prompted
each time.</p></div></div><h2 id=why-do-i-need-to-do-this>Why do I need to do this?</h2><p>For ✨security✨&mldr;</p><p>From August 2021, GitHub announced they would not be allowing password authentication
when using the command line to interact with github.com
<a href=#footnote--1><sup>[1]</sup></a>
.</p><p>This means that in order to interact with GitHub from the command line you have to
create an &ldquo;authentication token&rdquo;.</p><h2 id=what-are-authentication-tokens>What are authentication tokens?</h2><blockquote><p>An Authentication Token (auth token) is a piece of information that verifies the
identity of a user to a website, server, or anyone requesting verification of the
user’s identity.</p><p>&ndash; Twilio
<a href=#footnote--2><sup>[2]</sup></a></p></blockquote><p>There are a number of different types of authentication tokeb, including personal access tokens and SSH keys</p><h2 id=using-ssh-keys> Using SSH keys</h2><h3 id=how-do-i-create-and-use-ssh-keys>How do I create and use SSH keys</h3><p>The process for creating and using SSH keys is enumerated in the <a href=https://docs.github.com/en/authentication/connecting-to-github-with-ssh>GitHub
documentation</a>
<a href=#footnote--3><sup>[3]</sup></a>
.</p><h3 id=tips-and-gotchas>Tips and gotchas</h3><p>When using SSH keys, there are a couple of things which can make your life easier/harder. Some of them I have encountered are enumerated below.</p><h4 id=avoiding-password-prompts-on-macos>Avoiding password prompts on MacOS</h4><p>On MacOS, the SSH key password can be added to the user keychain, significantly
reducing the friction when interacting with the remote. This step is listed in
the GitHub docs for MacOS, first updating the SSH config file as follows:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>Host github.com
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>  AddKeysToAgent yes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>  UseKeychain yes
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>  IdentityFile ~/.ssh/id_ed25519
</span></span></code></pre></div><p>Then, using the following command when adding the SSH key:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>ssh-add --apple-use-keychain ~/.ssh/id_ed25519
</span></span></code></pre></div><h4 id=correctly-configuring-remotes>Correctly configuring remotes</h4><p>An easy point of confusion when using SSH keys is that different remotes are
required than when authenticating over HTTPS. For HTTPS, remotes tend to look
like:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>https://github.com/&lt;USERNAME&gt;/&lt;REPOSITORY&gt;
</span></span></code></pre></div><p>But when using SSH keys, remotes must be of the following format:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>git@github.com:&lt;USERNAME&gt;/&lt;REPOSITORY&gt;
</span></span></code></pre></div><p>As such, you may need to modify some repository remotes if switching from HTTPS
to SSH authentication. This can be done as follows, for the example of the <code>origin</code> remote:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>git remote remove origin
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>git remote add origin git@github.com:&lt;USERNAME&gt;/&lt;REPOSITORY&gt;
</span></span></code></pre></div><h2 id=using-personal-access-tokens>Using personal access tokens</h2><p>Personal access tokens are randomly generated strings which can be used in
place of passwords, but can be configured to expire, are easily revoked if
exposed, and can have restricted scope.</p><h3 id=how-do-i-create-an-personal-access-token>How do I create an personal access token?</h3><p>Visit <a href=https://github.com/settings/tokens>https://github.com/settings/tokens</a>. This can also be found by navigating
to &ldquo;Settings>Developer Settings>Personal access tokens>Tokens (classic)&rdquo;</p><p>You can then create a new token with the &ldquo;Generate new token (classic)&rdquo; button. You can
also create fine-grained tokens for individual repositories, but for general use classic
tokens are easier.</p><figure><img src=/images/posts/github_token_authentication/generate_token.png alt="Screenshot of the button to generate a new token."><figcaption><p>Screenshot of the button to generate a new token.</p></figcaption></figure><p>After you have pressed this button, you may be prompted for 2-factor authentication.
Once you have authenticated, you should see a screen like this:</p><figure><img src=/images/posts/github_token_authentication/new_personal_token.png alt="Screenshot of the screen to create a new token."><figcaption><p>Screenshot of the screen to create a new token.</p></figcaption></figure><p>There are three things you want to set here:</p><ol><li>Give your token a meaningful name! For example, the name of the machine where
it will be used, and what it will be used for. This also implies the good
practice of not re-using tokens, meaning revoking them is a low-cost operation.</li><li>Set an appropriate expiry date for your token.</li><li>Select the scopes for the token. A possible general set of scopes for common tasks is:<ul><li><code>repo</code></li><li><code>workflow</code></li><li><code>user</code></li></ul></li></ol><p>Once you have set all these fields, click the green &ldquo;Generate token&rdquo; button at the
bottom of the page. After the button is pressed a screen like this should be shown:</p><figure><img src=/images/posts/github_token_authentication/created_token.png alt="Screenshot of the screen once a new token is created."><figcaption><p>Screenshot of the screen once a new token is created.</p></figcaption></figure><p>The generated token should start with a <code>ghp_</code> prefix.</p><div class="admonition note"><div class=admonition-title>Note:</div><div class=admonition-content><strong>You must copy this token now!</strong> You&rsquo;ll never be able to see it again once the page closes.</div></div><div class="admonition warning"><div class=admonition-title>Warning:</div><div class=admonition-content><strong>This token acts like a password! You shouldn&rsquo;t show anyone it, and should revoke
it if anyone sees it</strong>. To delete a token, click the delete button on the tokens page.</div></div><figure><img src=/images/posts/github_token_authentication/delete_token.png alt="Screenshot of the screen to delete a token."><figcaption><p>Screenshot of the screen to delete a token.</p></figcaption></figure><p>You can also read a different set of instructions for this process
<a href=https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-personal-access-token-classic>on the GitHub website</a>
<a href=#footnote--4><sup>[4]</sup></a>
.</p><h3 id=how-do-i-use-it-on-my-computer>How do I use it on my computer?</h3><p>Once you have generated a token, you need to add it to the machine you intend to use it
on. There are various ways to do this, but in this tutorial we will use the git credential
<code>store</code> helper. This stores the token in a plaintext format in your home directory.
This is not an ideal solution, but since the file permissions are set to only be
readable to your user account, and tokens can easily be revoked if compromised, it is
probably an acceptable amount of risk for personal systems. Depending on your threat
vectors and the type of system being used, this may be an unacceptable level of risk,
in which case you should investigate a different storage strategy.</p><p>To store your token, in a terminal type
<a href=#footnote--5><sup>[5]</sup></a>
:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>git config --global credential.helper store
</span></span></code></pre></div><p>Then, make a commit or otherwise interact with the GitHub site from the command line.
You will be prompted for your username and password. Enter the email address for your
GitHub account for the username, and paste the token as the password.</p><p>You should then be able to make commits in future without being prompted for your
credentials again.</p><h3 id=what-did-that-just-do>What did that just do?</h3><p>To see where your credentials are stored, in a terminal type:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>vim ~/.git-credentials
</span></span></code></pre></div><p>This will open the file, and you should be able to see your email and token in this file.</p><p>You can also confirm the file permissions for this file as readable only by you by
typing in a terminal:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>ls -alFh | grep credentials
</span></span></code></pre></div><p>Which should print something similar to:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>-rw-------  1 &lt;username&gt; &lt;username&gt;   85 &lt;date&gt; .git-credentials
</span></span></code></pre></div><h2 id=references>References</h2><ul><li><span id=footnote--1>[1]</span>: <a href=https://github.blog/changelog/2021-08-12-git-password-authentication-is-shutting-down/>https://github.blog/changelog/2021-08-12-git-password-authentication-is-shutting-down/</a></li><li><span id=footnote--2>[2]</span>: <a href=https://www.twilio.com/docs/glossary/what-is-an-authentication-token>https://www.twilio.com/docs/glossary/what-is-an-authentication-token</a></li><li><span id=footnote--3>[3]</span>: <a href=https://docs.github.com/en/authentication/connecting-to-github-with-ssh>https://docs.github.com/en/authentication/connecting-to-github-with-ssh</a></li><li><span id=footnote--4>[4]</span>: <a href=https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-personal-access-token-classic>https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-personal-access-token-classic</a></li><li><span id=footnote--5>[5]</span>: <a href=https://stackoverflow.com/a/64632086>https://stackoverflow.com/a/64632086</a></li></ul></article></section><footer id=footer><div class=separated-items><span class=separated-item>© 2024</span>
<span class=separated-item><a href=https://github.com/EdmundGoodman>Edmund Goodman</a>
</span><span class=separated-item><a href=https://creativecommons.org/licenses/by-nc/4.0/>CC BY-NC 4.0</a></span></div></footer></body></html>